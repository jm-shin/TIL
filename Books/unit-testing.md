# 단위 테스트

### 1.1 단위 테스트 현황

단위 테스트와 통합 테스트를 통해 좋은 코드 커버리지를 달성해야함. 테스트 작성에서 그치는 것이 아닌 노력 대비 최대 이익을 끌어내는 방식으로 단위 테스트를 수행해야 하는 것.

### 1.2 단위 테스트 목표

- 소프트웨어 프로젝트의 **지속 가능한 성장**을 가능하게 하는 것.
- 테스트가 없다면 개발 속도가 빠르게 감소하는 현상인 엔트로피가 나타난다.
- 지속적인 정리와 리팩터링이 없다면 코드는 점점 무질서도(엔트로피)가 증가하여 시스템이 복잡해지고 무질서해진다.
- 이러한 경향을 테스트로 뒤집을 수 있다. 안전망 역할을 하며 회귀에 대한 보험을 제공하는 도구이다. 테스트는 새로운 기능을 도입하거나 새로운 요구 사항에 더 잘 맞게 리팩터링 한 후에도 기존 기능이 잘 동작하는지
  확인하는 데 도움이 된다.

단점도 생각해 볼 수 있는데 이러한 테스트는 초반에 상당한 노력이 필요하다는 것이다. 그러나 프로젝트 후반까지 장기적으로 보면 그 비용을 메울 수 있다. 코드베이스를 지속적으로 검증하는 테스트 없이는 소프트웨어
개발이 쉽게 확장하기 어렵다. 지속성과 확정성이 핵심이며, 이를 통해 장기적으로 개발 속도를 유지할 수 있다.

### 1.3 테스트 스위트 품질 측정을 위한 커버리지 지표

커버리지 지표는 테스트 스위트가 소스 코드를 얼마나 실행하는지를 백분율로 나타낸다.

#### 1.3.1 코드 커버리지

코드 커버리지(테스트 커버리지) = 제품 코드 라인 수 / 전체 라인 수

#### 1.3.2 분기 커버리지

분기 커버리지 = 통과 분기 / 전체 분기 수

#### 1.3.3 커버리지 지표에 관한 문제점

- 테스트 대상 시스템의 모든 가능한 결과를 검증한다고 보장할 수 없다.
- 외부 라이브러리의 코드 경로를 고려할 수 있는 커버리지 지표는 없다.

#### 1.3.4 특정 커버리지 숫자를 목표로 하기

커버리지 지표는 좋은 부정 지표지만 나쁜 긍정 지표다. 커버리지 숫자가 낮으면(예: 60%미만) 문제 징후라고 할 수 있다. 코드베이스에 테스트되지 않은 코드가 많다는 뜻이다. 그러나 높은 숫자도 별 의미가 없다.
그러므로 코드 커버리지 측정은 품질 테스트 스위트로 가는 첫 단계일 뿐임.

### 1.4 무엇이 성공적인 테스트 스위트를 만드는가?

- 개발 주기에 통합돼 있다.
- 코드베이스에서 가장 중요한 부분만을 대상으로 한다.
- 최소한의 유지비로 최대의 가치를 끌어낸다.

#### 1.4.1 개발 주기에 통합돼 있음

자동화된 테스트를 할 수 있는 방법은 끊임없이 하는 것 뿐. 모든 테스트는 개발 주기에 통합돼야 한다. 코드가 변경될 때마다 아무리 작은 것이라도 실행해야 한다.

#### 1.4.2 코드베이스에서 가장 중요한 부분만을 대상으로 함

테스트의 가치는 테스트 구조뿐만 아니라 검증하는 코드에도 있다. 코드베이스 모든 부분에 주목할 필요는 없다. 즉, 시스템의 가장 중요한 부분에 단위 테스트 노력을 기울이고, 다른 부분은 간략하게 또는 간접적으로
검증하는 것이 좋다. 대부분 애플리케이션에서 가장 중요한 부분은 비즈니스 로직(도메인 모델)이 있는 부분이다. 비즈니스 로직 테스트가 시간 투자 대비 최고의 수익을 낼 수 있다.
다른 모든 부분은 세 가지 범주로 나눌 수 있다.

- 인프라 코드
- 데이터베이스나 서드파티 시스템과 같은 외부 서비스 및 종속성
- 모든 것을 하나로 묶는 코드

#### 1.4.3 최소한의 유지비로 최대의 가치를 끌어냄

- 가치 있는 테스트(더 나아가, 가치가 낮은 테스트) 식별하기
- 가치 있는 테스트 작성하기

### 1.5

동료에게 생각을 명확하게 전달하는 능력은 값으로 매길 수 없다. 소프트웨어 개발자는 그 결정이 내려진 이유를 정확히 설명할 수 없다면 설계 결정에 대해 완전히 인정받지 못한다.
